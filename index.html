<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>L&R Café</title>
<style>
body { font-family: Arial, sans-serif; background-color: #fff0f5; margin:0; padding:0; text-align:center; }
header { background-color: #ffb6c1; padding:20px; position:relative; }
h1,h2,h3,h4 { color:#d63384; }
button { background-color:#ff69b4; color:white; border:none; padding:10px 20px; margin:5px; cursor:pointer; border-radius:5px; }
button:hover { background-color:#ff85c1; }
input, textarea, select { padding:10px; margin:5px; width:80%; border:1px solid #ccc; border-radius:5px; }
textarea { height:80px; }
.message { font-weight:bold; }
.message.error { color:red; }
nav a { margin:10px; text-decoration:underline; cursor:pointer; color:#d63384; }
#login-screen, #register-screen, #menu-page, #stories-page, #admin-panel, #giftcard-panel, #message-panel, #notification-panel, #ai-chat { display:none; padding:20px; }
#adminAccessBtn { position:absolute; top:20px; right:20px; background:#8b0000; color:white; }
.eye-toggle { cursor:pointer; position:absolute; right:30px; top:65px; }
#chat-window { display:flex; flex-direction:column; overflow-y:auto; height:200px; padding:5px; border:1px solid #ccc; background:#f9f9f9; margin:10px 0; }
.chat-bubble { padding:8px; border-radius:10px; margin:5px 0; max-width:70%; }
.chat-admin { background:#8b4513; color:white; align-self:flex-end; }
.chat-customer { background:#eee; color:black; align-self:flex-start; }
.customer-item { padding:5px; border-bottom:1px solid #eee; cursor:pointer; }
.customer-list { max-height:200px; overflow-y:auto; border:1px solid #ccc; padding:5px; margin:10px 0; }
</style>
</head>
<body>

<header>
<h1 id="main-heading">Welcome to L&R Café ☕</h1>
<button id="adminAccessBtn" onclick="adminAccessPrompt()">Admin Access</button>
</header>

<!-- Site Access Code -->
<div id="code-screen">
<h2>Enter Site Access Code</h2>
<div style="position:relative; display:inline-block;">
<input type="password" id="siteCode" placeholder="Enter code">
<span class="eye-toggle" onclick="toggleCodeVisibility()">👁️</span>
</div>
<br>
<button onclick="checkSiteCode()">Enter</button>
<p class="message error" id="codeMessage"></p>
</div>

<!-- Choice Screen -->
<div id="choice-screen">
<h2>Choose Mode</h2>
<button onclick="showGuestRegister()">Continue as Guest</button>
<button onclick="adminAccessPrompt()">Admin Login</button>
</div>

<!-- Guest Registration -->
<div id="register-screen">
<h2>Guest Registration</h2>
<input type="text" id="name" placeholder="Full Name"><br>
<input type="email" id="email" placeholder="Email"><br>
<label>Date of Birth:</label><br>
<select id="dob-day"></select>
<select id="dob-month"></select>
<select id="dob-year"></select><br>
<button onclick="registerUser()">Submit</button>
<p class="message" id="registerMessage"></p>
</div>

<!-- Menu Page -->
<div id="menu-page">
<h2>Menu</h2>
<p>Delicious items appear here!</p>
<div id="guest-card"></div>
</div>

<!-- Stories Page -->
<div id="stories-page">
<h2>Stories</h2>
<p>Latest stories appear here!</p>
</div>

<!-- Admin Panel -->
<div id="admin-panel">
<h2>Admin Panel</h2>
<nav>
<a onclick="showMenuPage()">📜 Menu Upload/Edit</a>
<a onclick="showStoriesPage()">📸 Stories Upload/Edit</a>
<a onclick="viewRegistered()">👥 Users</a>
<a onclick="showGiftCard()">💳 Gift Cards</a>
<a onclick="showMessages()">💬 Messages</a>
<a onclick="showNotifications()">🔔 Notifications</a>
<a onclick="showAI()">🤖 AI Chat</a>
<a onclick="editHeader()">✏️ Edit Heading</a>
</nav>

<!-- Registered Users -->
<div id="userListPanel">
<h3>Registered Users:</h3>
<ul id="userList"></ul>
</div>

<!-- Gift Card Panel -->
<div id="giftcard-panel">
<h3>Gift Cards</h3>
<input type="text" id="gift-customer-name" placeholder="Customer Name">
<input type="email" id="gift-customer-email" placeholder="Email">
<input type="number" id="gift-amount" placeholder="Amount / Discount">
<select id="gift-partial"><option value="yes">Partial Use</option><option value="no">Full Only</option></select>
<input type="date" id="gift-expiry">
<select id="notify-customer"><option value="yes">Notify Customer</option><option value="no">Don't Notify</option></select>
<button onclick="saveGiftCard()">Save Gift Card</button>
<div class="customer-list" id="gift-customer-list"></div>
</div>

<!-- Message Panel -->
<div id="message-panel">
<h3>Customer Messages</h3>
<div style="display:flex; gap:20px;">
<div style="width:200px;">
<h4>Customers</h4>
<div id="chat-customer-list"></div>
</div>
<div style="flex:1; display:flex; flex-direction:column;">
<div id="chat-window"></div>
<input type="text" id="chat-input" placeholder="Type message...">
<button onclick="sendChat()">Send</button>
</div>
</div>
</div>

<!-- Notification Panel -->
<div id="notification-panel">
<h3>Discounts & Expiry Alerts</h3>
<button onclick="sendDiscount()">Send Discount</button>
<ul id="expiry-list"></ul>
</div>

<!-- AI Chat -->
<div id="ai-chat">
<h3>Ask Our Café Assistant 🤖</h3>
<textarea id="chatInput" placeholder="Ask something..."></textarea><br>
<button onclick="aiRespond()">Ask</button>
<p id="aiResponse" class="message"></p>
</div>

<script>
// --- Data ---
const SITE_CODE="LRCafe2025";
const ADMIN_CODE="Pinkie2025bow";
const ADMIN_USERNAME="R.L@2025.cafe";

let users=[]; // Guest users
let giftCards=[];
let messages={};
let selectedUser=null;

// --- DOB Dropdown ---
function populateDOB(){
const day=document.getElementById("dob-day");
const month=document.getElementById("dob-month");
const year=document.getElementById("dob-year");
for(let i=1;i<=31;i++) day.innerHTML+=`<option>${i}</option>`;
const months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
months.forEach(m=>month.innerHTML+=`<option>${m}</option>`);
const currentYear=new Date().getFullYear();
for(let y=currentYear;y>=1900;y--) year.innerHTML+=`<option>${y}</option>`;
}
populateDOB();

// --- Hide All Screens ---
function hideAllScreens(){
["code-screen","choice-screen","register-screen","menu-page","stories-page","admin-panel","giftcard-panel","message-panel","notification-panel","ai-chat"].forEach(id=>document.getElementById(id).style.display="none");
}

// --- Toggle Code Visibility ---
function toggleCodeVisibility(){
const input=document.getElementById("siteCode");
input.type=input.type==="password"?"text":"password";
}

// --- Site Code Check ---
function checkSiteCode(){
const code=document.getElementById("siteCode").value;
const msg=document.getElementById("codeMessage");
if(code===SITE_CODE){msg.innerText=""; hideAllScreens(); document.getElementById("choice-screen").style.display="block";}
else msg.innerText="❌ Incorrect code!";
}

// --- Guest Registration ---
function showGuestRegister(){hideAllScreens(); document.getElementById("register-screen").style.display="block";}
function registerUser(){
const name=document.getElementById("name").value;
const email=document.getElementById("email").value;
const day=document.getElementById("dob-day").value;
const month=document.getElementById("dob-month").value;
const year=document.getElementById("dob-year").value;
if(!name||!email||!day||!month||!year){document.getElementById("registerMessage").innerText="Fill all fields!";return;}
users.push({name,email,dob:`${day}-${month}-${year}`});
messages[email]=[];
document.getElementById("registerMessage").innerText=`Welcome ${name}! 🎉`;
hideAllScreens(); document.getElementById("menu-page").style.display="block"; document.getElementById("stories-page").style.display="block";
displayGuestCard(email);
}

// --- Display Guest Card ---
function displayGuestCard(email){
const card=document.getElementById("guest-card");
const gc=giftCards.find(g=>g.email===email);
card.innerHTML=gc?`
